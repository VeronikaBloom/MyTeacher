<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</title>
    <link rel="stylesheet" href="schedule.css">
    <style>
        body { font-family: sans-serif; margin: 0; background: #f8f9fa; }
        header { background: #343a40; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; }
        header .logo { font-weight: bold; font-size: 1.2rem; }
        header nav a { color: white; margin-left: 1rem; text-decoration: none; }
        .container { max-width: 900px; margin: 2rem auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px #ccc; }
        .form-control, select { width: 100%; padding: 8px; margin-bottom: 10px; }
        .btn { padding: 8px 12px; margin: 4px; cursor: pointer; border: none; border-radius: 4px; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-small { font-size: 0.9rem; padding: 4px 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background: #e9ecef; }
    </style>
</head>
<body>
<header>
    <div class="logo">–ì–ê–ü–ü–û–£ –ö–ö –õ–°–ü–ö</div>
    <nav>
        <a href="teacher_dashboard.html" class="btn btn-secondary">–ù–∞–∑–∞–¥</a>
        <a href="login.html" class="btn btn-secondary">–í—ã–π—Ç–∏</a>
    </nav>
</header>

<div class="container">
    <h2 id="form-title">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ</h2>

    <div id="error-msg" style="color: red; font-weight: bold;"></div>

    <form id="schedule-form">
        <label>–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏</label>
        <select id="day_of_week" class="form-control" required>
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
            <option>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</option>
            <option>–í—Ç–æ—Ä–Ω–∏–∫</option>
            <option>–°—Ä–µ–¥–∞</option>
            <option>–ß–µ—Ç–≤–µ—Ä–≥</option>
            <option>–ü—è—Ç–Ω–∏—Ü–∞</option>
            <option>–°—É–±–±–æ—Ç–∞</option>
        </select>

        <label>–ù–æ–º–µ—Ä —É—Ä–æ–∫–∞</label>
        <input type="number" id="lesson_number" class="form-control" min="1" max="12" required>

        <label>–ü—Ä–µ–¥–º–µ—Ç</label>
        <input type="text" id="subject" class="form-control" required>

        <label>–ê—É–¥–∏—Ç–æ—Ä–∏—è</label>
        <input type="text" id="room" class="form-control" required>

        <label>–ì—Ä—É–ø–ø–∞</label>
        <input type="text" id="group" class="form-control" required>

        <input type="hidden" id="edit_index">
        <button type="submit" class="btn btn-primary" id="submit-btn">–î–æ–±–∞–≤–∏—Ç—å</button>
    </form>

    <h3>–¢–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
    <table id="schedule-table">
        <thead>
        <tr>
            <th>–î–µ–Ω—å</th>
            <th>–£—Ä–æ–∫</th>
            <th>–ü—Ä–µ–¥–º–µ—Ç</th>
            <th>–ê—É–¥–∏—Ç–æ—Ä–∏—è</th>
            <th>–ì—Ä—É–ø–ø–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const form = document.getElementById("schedule-form");
    const tableBody = document.querySelector("#schedule-table tbody");
    const errorMsg = document.getElementById("error-msg");
    let schedule = JSON.parse(localStorage.getItem("teacher_schedule")) || [];

    function renderTable() {
        tableBody.innerHTML = "";
        const order = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'];

        schedule.sort((a, b) => {
            return order.indexOf(a.day_of_week) - order.indexOf(b.day_of_week)
                || a.lesson_number - b.lesson_number;
        });

        schedule.forEach((item, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${item.day_of_week}</td>
                <td>${item.lesson_number}</td>
                <td>${item.subject}</td>
                <td>${item.room}</td>
                <td>${item.group}</td>
                <td>
                    <button class="btn btn-small" onclick="editEntry(${index})">‚úèÔ∏è</button>
                    <button class="btn btn-small btn-danger" onclick="deleteEntry(${index})">üóëÔ∏è</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    form.onsubmit = (e) => {
        e.preventDefault();
        const day = document.getElementById("day_of_week").value;
        const lesson = parseInt(document.getElementById("lesson_number").value);
        const subject = document.getElementById("subject").value.trim();
        const room = document.getElementById("room").value.trim();
        const group = document.getElementById("group").value.trim();
        const editIndex = document.getElementById("edit_index").value;

        if (!day || !lesson || !subject || !room || !group) {
            errorMsg.textContent = "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.";
            return;
        }

        const entry = { day_of_week: day, lesson_number: lesson, subject, room, group };

        if (editIndex === "") {
            schedule.push(entry);
        } else {
            schedule[editIndex] = entry;
            document.getElementById("submit-btn").textContent = "–î–æ–±–∞–≤–∏—Ç—å";
            document.getElementById("form-title").textContent = "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ";
        }

        localStorage.setItem("teacher_schedule", JSON.stringify(schedule));
        form.reset();
        document.getElementById("edit_index").value = "";
        errorMsg.textContent = "";
        renderTable();
    };

    function editEntry(index) {
        const entry = schedule[index];
        document.getElementById("day_of_week").value = entry.day_of_week;
        document.getElementById("lesson_number").value = entry.lesson_number;
        document.getElementById("subject").value = entry.subject;
        document.getElementById("room").value = entry.room;
        document.getElementById("group").value = entry.group;
        document.getElementById("edit_index").value = index;
        document.getElementById("submit-btn").textContent = "–û–±–Ω–æ–≤–∏—Ç—å";
        document.getElementById("form-title").textContent = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å";
    }

    function deleteEntry(index) {
        if (confirm("–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?")) {
            schedule.splice(index, 1);
            localStorage.setItem("teacher_schedule", JSON.stringify(schedule));
            renderTable();
        }
    }

    renderTable();
</script>
</body>
</html>