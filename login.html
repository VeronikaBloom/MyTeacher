<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Вход</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="register.css">
</head>
<body class="bg-light">

<header>
    <div class="logo">
        <img src="img/logo.png" alt="Логотип МойПедагог" class="logo-img">
        <span>МойПедагог</span>
    </div>
    
    <!-- Обычное меню -->
    <nav class="desktop-menu">
        <a href="index.html">Главная</a>
        <a href="register.html">Регистрация</a>
        <a href="about.html">О системе</a>
    </nav>
    
    <!-- Кнопка гамбургер-меню -->
    <button class="menu-toggle" aria-label="Меню">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <!-- Мобильное меню -->
    <div class="mobile-menu">
        <a href="index.html">Главная</a>
        <a href="register.html">Регистрация</a>
        <a href="about.html">О системе</a>
    </div>
</header>

<div class="container">
<h2>Вход в систему</h2>
<form id="loginForm">
    <div class="form-group">
    <label for="username">Имя пользователя</label>
    <input type="text" id="username" required>
    </div>

    <div class="form-group">
    <label for="password">Пароль</label>
    <input type="password" id="password" required>
    </div>

    <button type="submit">Войти</button>
    <p><a href="register.html">Нет аккаунта? Зарегистрироваться</a></p>
</form>
</div>

<script>
// Создание администратора, если он ещё не добавлен
const defaultAdmin = {
    username: "admin",
    password: "admin123",
    role: "admin"
};

let users = JSON.parse(localStorage.getItem("users")) || [];
if (!users.some(user => user.username === defaultAdmin.username)) {
    users.push(defaultAdmin);
    localStorage.setItem("users", JSON.stringify(users));
}

document.getElementById("loginForm").addEventListener("submit", function(event) {
    event.preventDefault();

    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;

    let users = JSON.parse(localStorage.getItem("users")) || [];

    const user = users.find(u => u.username === username && u.password === password);

    if (!user) {
        alert("Неверное имя пользователя или пароль.");
        return;
    }

    // Сохраняем текущего пользователя
    localStorage.setItem("currentUser", JSON.stringify(user));

    // Перенаправляем в зависимости от роли
    if (user.role === "teacher") {
        window.location.href = "teacher_dashboard.html";
    } else if (user.role === "student") {
        window.location.href = "student_dashboard.html";
    } else if (user.role === "admin") {
        window.location.href = "admin_dashboard.html";
    } else {
        alert("Неизвестная роль.");
    }
});

// Удаляем этот обработчик, так как он дублируется ниже
// document.getElementById('menuToggle').addEventListener('click', function() {
//     document.querySelector('nav').classList.toggle('active');
// });

// Скрипт для гамбургер-меню
document.addEventListener('DOMContentLoaded', function() {
    const menuToggle = document.querySelector('.menu-toggle');
    const mobileMenu = document.querySelector('.mobile-menu');
    
    menuToggle.addEventListener('click', function() {
        // Переключаем класс active для кнопки
        this.classList.toggle('active');
        
        // Переключаем класс active для меню
        mobileMenu.classList.toggle('active');
        
        // Блокировка/разблокировка скролла страницы
        if (mobileMenu.classList.contains('active')) {
            document.body.style.overflow = 'hidden';
        } else {
            document.body.style.overflow = '';
        }
    });
    
    // Закрываем меню при клике на ссылку
    const menuLinks = mobileMenu.querySelectorAll('a');
    menuLinks.forEach(link => {
        link.addEventListener('click', () => {
            mobileMenu.classList.remove('active');
            menuToggle.classList.remove('active');
            document.body.style.overflow = ''; // Восстанавливаем скролл
        });
    });
    
    // Закрываем меню при клике вне области меню
    document.addEventListener('click', (event) => {
        const isClickInsideMenu = mobileMenu.contains(event.target);
        const isClickOnToggle = menuToggle.contains(event.target);
        
        if (mobileMenu.classList.contains('active') && !isClickInsideMenu && !isClickOnToggle) {
            mobileMenu.classList.remove('active');
            menuToggle.classList.remove('active');
            document.body.style.overflow = ''; // Восстанавливаем скролл
        }
    });
});
</script>

</body>
</html>
